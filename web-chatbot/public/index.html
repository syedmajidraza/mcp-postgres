<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PostgreSQL MCP Chatbot</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Floating Chat Button -->
    <button id="chatToggleBtn" class="chat-toggle-btn" onclick="toggleChat()">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span class="notification-badge" id="notificationBadge" style="display: none;">1</span>
    </button>

    <!-- Popup Chat Container -->
    <div id="chatPopup" class="chat-popup">
        <div class="popup-container">
            <!-- Header -->
            <header class="header">
                <div class="header-content">
                    <h1>üóÑÔ∏è PostgreSQL Assistant</h1>
                    <p class="subtitle" id="providerSubtitle">
                        Powered by AI
                        <button onclick="changeProvider()" style="margin-left: 10px; padding: 4px 12px; font-size: 11px; background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3); border-radius: 4px; color: inherit; cursor: pointer;">Change Provider</button>
                    </p>
                </div>
                <div class="header-actions">
                    <button id="statusBtn" class="status-btn" onclick="checkStatus()">
                        <span class="status-dot"></span>
                    </button>
                    <button class="minimize-btn" onclick="toggleChat()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <line x1="5" y1="12" x2="19" y2="12" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </button>
                </div>
            </header>

            <!-- MCP Connection Info -->
            <div id="mcpInfo" class="mcp-info">
                <div class="mcp-status">
                    <span class="mcp-indicator"></span>
                    <span id="mcpStatusText">Checking connection...</span>
                </div>
            </div>

            <!-- Chat Interface -->
            <div id="chatInterface" class="chat-interface">
                <!-- Chat Messages -->
                <div class="chat-messages" id="chatMessages">
                    <div class="welcome-message">
                        <h2>üëã Welcome!</h2>
                        <p>Ask me anything about your PostgreSQL database.</p>
                        <div class="example-queries">
                            <h3>Try asking:</h3>
                            <button class="example-query" onclick="sendExample(this)">Show all tables</button>
                            <button class="example-query" onclick="sendExample(this)">What's the minimum salary?</button>
                            <button class="example-query" onclick="sendExample(this)">Create a products table</button>
                        </div>
                    </div>
                </div>

                <!-- Input Area -->
                <div class="input-area">
                    <form id="chatForm" onsubmit="sendMessage(event)">
                        <textarea
                            id="messageInput"
                            placeholder="Ask a question about your database..."
                            rows="1"
                            onkeydown="handleKeyPress(event)"
                        ></textarea>
                        <button type="submit" id="sendBtn">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                <path d="M22 2L11 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M22 2L15 22L11 13L2 9L22 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Status Modal -->
    <div id="statusModal" class="modal" onclick="closeModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2>System Status</h2>
            <div id="statusContent"></div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
